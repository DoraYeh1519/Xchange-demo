<!DOCTYPE html>
{% from "bootstrap5/form.html" import render_form %}
<html lang="en">
  <head>
    <title>Profile</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Abril+Fatface&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/static/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="/static/css/animate.css">

    <link rel="stylesheet" href="/static/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/static/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="/static/css/magnific-popup.css">

    <link rel="stylesheet" href="/static/css/aos.css">

    <link rel="stylesheet" href="/static/css/ionicons.min.css">

    <link rel="stylesheet" href="/static/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/static/css/jquery.timepicker.css">


    <link rel="stylesheet" href="/static/css/flaticon.css">
    <link rel="stylesheet" href="/static/css/icomoon.css">
    <link rel="stylesheet" href="/static/css/style.css">

    <style>
    .masthead {
      position: relative;
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center center;
      padding: 100px 0;
      color: white;
      padding-top: 150px;
      padding-bottom: 100px;
    }
    .masthead .container {
      position: relative;
      z-index: 2;
    }
    .masthead .page-heading {
      text-align: center;
      margin-top: 0;
    }
    .masthead .site-heading h1 {
      font-size: 3rem;
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: 1rem;
      color: #FFFFFF;
    }
    .masthead .page-heading .subheading {
      font-size: 1.25rem;
      font-weight: 300;
      line-height: 1.2;
    }
    .masthead::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }
    .main-content {
      background-color: #f8f9fa; /* Light background to highlight the content */
      padding: 20px;
      border-radius: 10px; /* Rounded corners */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Add a subtle shadow */
      margin-top: 30px; /* Add margin-top to create space from the header */
    }

    .user-info ul {
      list-style-type: none; /* Remove bullets from the list */
      padding: 0;
    }

    .user-info ul li {
      margin-bottom: 10px; /* Add space between list items */
    }

    .user-info ul li strong {
      display: inline-block;
      width: 100px; /* Fixed width for labels */
    }

    .post-section, .tagged-section {
      background-color: #ffffff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin-top: 30px;
      margin-bottom: 30px;
      width: 100%;
      max-width: 1000px;
      margin-left: auto;
      margin-right: auto;
    }

    </style>
  </head>

  <body>

  {% include "navbar.html" %}

  <!-- Page Header -->
<div id="colorlib-main">
  <section class="ftco-section ftco-no-pt ftco-no-pb">
    <header class="masthead" style="background-image: url('{{ url_for('static', filename='assets/img/' + (user.profile_img_url if user.profile_img_url else 'login-bg.jpg'))}}')">
      <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
          <div class="col-md-10 col-lg-8 col-xl-7">
            <div class="site-heading">
              <h1>{{ user_student_type }} Profile</h1>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="col mb-4">
      <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
          <!-- Left Column (Post Content) -->
          <div class="col-md-8">
            <article class="main-content">
              <div class="container">
                <div class="row justify-content-center">
                  <div class="col-md-10 col-lg-12 col-xl-9">
                    <div class="user-info">
                      {% if user_student_type == 'International Student' %}
                      <ul>
                        <li><strong>Name:</strong> {{ user.user_name }}</li>
                        <li><strong>Email:</strong> {{ user.email }}</li>
                        <li><strong>Studying:</strong> {{ detailed_info.origin_school }}</li>
                        <li><strong>From:</strong> {{ detailed_info.country }}, {{ detailed_info.region }}</li>
                        <li><strong>Info:</strong> {{ detailed_info.info }}</li>
                      </ul>
                      {% elif user_student_type == 'Taiwanese Student' %}
                      <ul>
                        <li><strong>Name:</strong> {{ user.user_name }}</li>
                        <li><strong>Email:</strong> {{ user.email }}</li>
                        <li><strong>Studying:</strong> {{ detailed_info.exchanging_school }}</li>
                        <li><strong>In:</strong> {{ detailed_info.country }}, {{ detailed_info.region }}</li>
                        <li><strong>Info:</strong> {{ detailed_info.info }}</li>
                      </ul>
                      {% else %}
                      <ul>
                        <li><strong>Name:</strong> {{ user.user_name }}</li>
                        <li><strong>Info:</strong> {{ detailed_info.info }}</li>
                      </ul>
                      {% endif %}
                      {% if is_profile_user and user_student_type != 'Xchange'%}
                      <div class="d-flex justify-content-center mb-4">
                        <a class="btn btn-primary float-right" href="{{url_for('edit_profile', user_id=user.user_id)}}">Edit Profile</a>
                      </div>
                      {% endif %}
                    </div>
                  </div>
                </div>
              </div>
            </article>
          </div>

          <!-- Add spacing here -->
          <div style="height: 50px;"></div>

          <!-- Posts by the User -->
          <div class="post-section">
            <h2 class="mb-4">Posts by {{ user.user_name }}</h2>
            <div class="row no-gutters">
              {% for post in posts %}
              {% if post.author_id == user.user_id %}
                <div class="col-md-6">
                  <div class="blog-entry ftco-animate d-md-flex align-items-center">
                    <img src="{{ post.img_url }}" alt="Thumbnail Image" class="img img-2 popup-vimeo d-flex align-items-center justify-content-center" style="object-fit: cover;">
                    <div class="text text-2 p-4">
                      <h3 class="mb-2"><a href="{{ url_for('show_post', post_id=post.blogpost_id) }}">{{ post.title }}</a></h3>
                      <div class="meta-wrap">
                        <p class="meta">
                          <span><i class="icon-calendar mr-2"></i>{{ post.upload_date }}</span>
                          <span><a href="single.html"><i class="icon-folder-o mr-2"></i>By {{ post.author.user_name }}</a></span>
                          <span><i class="icon-comment2 mr-2"></i>{{ post.views }} Views</span>
                        </p>
                        <p class="mb-4">For people overwhelmed by the thousands of islands</p>
                        <p><a href="{{ url_for('show_post', post_id=post.blogpost_id) }}" class="btn-custom">Read More <span class="ion-ios-arrow-forward"></span></a></p>
                      </div>
                    </div>
                  </div>
                </div>
              {% endif %}
              {% endfor %}
            </div>
          </div>

          <!-- Add spacing here -->
          <div style="height: 50px;"></div>

          <!-- Tagged Posts -->
          <div class="tagged-section">
            <h2 class="mb-4">Tagged Posts</h2>
            <div class="row no-gutters">
              {% for post in tagged_posts %}
                <div class="col-md-6">
                  <div class="blog-entry ftco-animate d-md-flex align-items-center">
                    <img src="{{ post.img_url }}" alt="Thumbnail Image" class="img img-2 popup-vimeo d-flex align-items-center justify-content-center" style="background-image: url({{ url_for('static', filename='images/image_2.jpg') }});">
                    <div class="text text-2 p-4">
                      <h3 class="mb-2"><a href="{{ url_for('show_post', post_id=post.blogpost_id) }}">{{ post.title }}</a></h3>
                      <div class="meta-wrap">
                        <p class="meta">
                          <span><i class="icon-calendar mr-2"></i>{{ post.upload_date }}</span>
                          <span><a href="{{ url_for('profile', user_id=post.author_id) }}"><i class="icon-folder-o mr-2"></i>By {{ post.author.user_name }}</a></span>
                          <span><i class="icon-comment2 mr-2"></i>{{ post.views }} Views</span>
                        </p>
                        <p class="mb-4">For people overwhelmed by the thousands of islands</p>
                        <p><a href="{{ url_for('show_post', post_id=post.blogpost_id) }}" class="btn-custom">Read More <span class="ion-ios-arrow-forward"></span></a></p>
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>

          <div class="modal fade" id="flashModal" tabindex="-1" aria-labelledby="flashModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="flashModalLabel">Messages</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modalBodyContent">
                  <!-- Flash messages will be dynamically loaded here -->
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const flashMessages = JSON.parse('{{ get_flashed_messages()|tojson }}');
      if (flashMessages.length > 0) {
        const modalBodyContent = document.getElementById('modalBodyContent');
        modalBodyContent.innerHTML = '';
        flashMessages.forEach(message => {
          const p = document.createElement('p');
          p.textContent = message;
          modalBodyContent.appendChild(p);
        });
        const flashModal = new bootstrap.Modal(document.getElementById('flashModal'));
        flashModal.show();
      }
    });
  </script>

  <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery-migrate-3.0.1.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/popper.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.easing.1.3.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.waypoints.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.stellar.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/owl.carousel.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.magnific-popup.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/aos.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.animateNumber.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap-datepicker.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.timepicker.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/scrollax.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/google-map.js') }}"></script>
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>

  </body>
</html>